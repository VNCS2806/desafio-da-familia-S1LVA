# desafio-da-familia-S1LVA
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Missão da Semana - Game Familiar</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1, h2 { text-align: center; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f4f4f4; }
    .controls, #loginArea { text-align: center; margin-bottom: 20px; }
    input, select, button { font-size: 14px; padding: 6px; margin: 4px; }
    #suggestionsTable, #masterTable { display: none; margin-top: 20px; }
    #searchInput, #newTaskInput { width: calc(100% - 16px); }
    .copy-btn { position: absolute; top: 8px; right: 8px; }
  </style>
</head>
<body>

  <div id="loginArea">
    <h2>Login</h2>
    <label>Usuário: <input id="loginUser" /></label>
    <label>Senha: <input type="password" id="loginPass" /></label>
    <button onclick="login()">Entrar</button>
  </div>

  <div id="mainContent" style="display:none;">
    <h1>Missão da Semana - Game Familiar</h1>
    <div class="controls">
      <label>Jogador:
        <select id="playerSelect">
          <option>Alan</option>
          <option>Daniela</option>
        </select>
      </label>
      <label>Pontos:
        <select id="pointSelect"></select>
      </label>
      <button onclick="addEntry()">Adicionar Pontos</button>
      <input type="file" id="imageInput" accept="image/*"/>
      <button onclick="addImage()">Anexar Imagem</button>
      <button onclick="showSuggestions()">Ver Sugestões</button>
      <button onclick="showSummary()">Resumo Semanal</button>
      <button onclick="resetEntries()">Zerar Geral</button>
      <button onclick="logout()">Logout</button>
      <button id="masterBtn" onclick="showMasterView()" style="display:none;">Ver Detalhado (Mestre)</button>
    </div>

    <table>
      <thead>
        <tr>
          <th>#</th><th>Jogador</th><th>Pontos</th><th>Hora</th><th>Por</th><th>Imagem</th><th>Ação</th>
        </tr>
      </thead>
      <tbody id="entries"></tbody>
    </table>

    <div id="summary"></div>

    <div id="suggestionsTable">
      <h2>Sugestões de Tarefas</h2>
      <input type="text" id="searchInput" placeholder="Buscar tarefa..." oninput="filterSuggestions()"/>
      <ul id="suggestionList"></ul>
      <input type="text" id="newTaskInput" placeholder="Nova tarefa..."/>
      <button onclick="addTask()">Adicionar Tarefa</button>
    </div>

    <div id="masterTable">
      <h2>Visão Detalhada (Mestre)</h2>
      <table>
        <thead>
          <tr>
            <th>#</th><th>Jogador</th><th>Pontos</th>
            <th>Hora</th><th>Por</th><th>Dispositivo</th><th>Imagem</th>
          </tr>
        </thead>
        <tbody id="masterEntries"></tbody>
      </table>
    </div>
  </div>

  <script>
    const users = { "Daniela":"200786", "Alan":"170482", "VNCS2806":"28062012" };
    let loggedUser = localStorage.getItem("user");
    const deviceName = navigator.userAgent;
    let entries = JSON.parse(localStorage.getItem("entries")||"[]");
    let tasks   = JSON.parse(localStorage.getItem("tasks")||"[]");
    let idCnt   = entries.length?Math.max(...entries.map(e=>e.id))+1:1;

    // preencher pontos
    const ptSel = document.getElementById("pointSelect");
    for(let i=-50;i<=50;i++) if(i) {
      let o=document.createElement("option");
      o.value=i; o.textContent=i;
      ptSel.appendChild(o);
    }

    // iniciar sugestões
    if(!tasks.length){
      for(let i=1;i<=400;i++) tasks.push("Tarefa "+i);
      localStorage.setItem("tasks",JSON.stringify(tasks));
    }

    function login(){
      let u=document.getElementById("loginUser").value;
      let p=document.getElementById("loginPass").value;
      if(users[u]&&users[u]===p){
        loggedUser=u; localStorage.setItem("user",u);
        document.getElementById("loginArea").style.display="none";
        document.getElementById("mainContent").style.display="block";
        if(u==="VNCS2806") document.getElementById("masterBtn").style.display="inline";
        renderEntries(); renderSuggestions();
      } else alert("Credenciais inválidas");
    }

    function logout(){ localStorage.removeItem("user"); location.reload(); }

    function save(){
      localStorage.setItem("entries",JSON.stringify(entries));
      localStorage.setItem("tasks",JSON.stringify(tasks));
    }

    function addEntry(imgUrl){
      let pl=document.getElementById("playerSelect").value;
      let pts=parseInt(ptSel.value);
      let ts=new Date().toLocaleString();
      let e={ id:idCnt++, player:pl, points:pts, timestamp:ts,
              addedBy:loggedUser, device:deviceName, image:imgUrl||"" };
      entries.push(e); save(); renderEntries();
    }

    function addImage(){
      let inp=document.getElementById("imageInput");
      if(!inp.files.length) return alert("Selecione imagem");
      let url=URL.createObjectURL(inp.files[0]);
      addEntry(url);
      inp.value="";
    }

    function deleteEntry(id){
      entries=entries.filter(e=>e.id!==id); save(); renderEntries();
    }

    function renderEntries(){
      let tb= document.getElementById("entries");
      tb.innerHTML="";
      entries.forEach(e=>{
        let tr=document.createElement("tr");
        tr.innerHTML=`
          <td>${e.id}</td>
          <td>${e.player}</td>
          <td>${e.points}</td>
          <td>${e.timestamp}</td>
          <td>${e.addedBy}</td>
          <td>${e.image?'<img src="'+e.image+'" width="40"/>':''}</td>
          <td><button onclick="deleteEntry(${e.id})">Excluir</button></td>`;
        tb.appendChild(tr);
      });
    }

    function resetEntries(){
      if(confirm("Zerar tudo?")){
        entries=[];idCnt=1;save(); renderEntries();
        document.getElementById("summary").innerHTML="";
      }
    }

    function showSummary(){
      let sum={}; entries.forEach(e=> sum[e.player]=(sum[e.player]||0)+e.points);
      let html="";
      ["Alan","Daniela"].forEach(p=>{
        html+=`<p>${p}: ${sum[p]||0}/300</p>`;
      });
      document.getElementById("summary").innerHTML=html;
    }

    function showSuggestions(){
      let tbl=document.getElementById("suggestionsTable");
      tbl.style.display= tbl.style.display==="none"?"block":"none";
    }

    function renderSuggestions(){
      let ul=document.getElementById("suggestionList");
      ul.innerHTML="";
      tasks.forEach(t=>{
        let li=document.createElement("li"); li.textContent=t;
        ul.appendChild(li);
      });
    }

    function filterSuggestions(){
      let q=document.getElementById("searchInput").value.toLowerCase();
      document.querySelectorAll("#suggestionList li")
        .forEach(li=>li.style.display=li.textContent.toLowerCase().includes(q)?"":"none");
    }

    function addTask(){
      let t=document.getElementById("newTaskInput").value.trim();
      if(!t) return;
      if(tasks.some(x=>x.toLowerCase()===t.toLowerCase())) 
        return alert("Já existe");
      tasks.push(t); save(); renderSuggestions();
      document.getElementById("newTaskInput").value="";
    }

    function showMasterView(){
      let tbl=document.getElementById("masterTable");
      tbl.style.display= tbl.style.display==="none"?"block":"none";
      let tb=document.getElementById("masterEntries"); tb.innerHTML="";
      entries.forEach(e=>{
        let tr=document.createElement("tr");
        tr.innerHTML=`
          <td>${e.id}</td>
          <td>${e.player}</td>
          <td>${e.points}</td>
          <td>${e.timestamp}</td>
          <td>${e.addedBy}</td>
          <td>${e.device}</td>
          <td>${e.image?'<img src="'+e.image+'" width="40"/>':''}</td>`;
        tb.appendChild(tr);
      });
    }

    // inicializar
    if(loggedUser) login();
  </script>

</body>
</html>
